---
title:  "[AWS] 4주차-2 CloudFormation, EFS 실습"
subtitle:   "CloudFormation, EFS 실습"
categories: AWS
date: 2021-06-30 23:00:00
tags: AFOS[2기]
---



`cloudFormation` -> `스택 생성` 클릭
<br/>

<img width="419" alt="스크린샷 2021-06-30 오후 10 24 15" src="https://user-images.githubusercontent.com/76810787/123975057-0ee5f380-d9f8-11eb-9cce-231066b643be.png">
<br/>

URL에 `https://s3.ap-northeast-2.amazonaws.com/cloudformation.cloudneta.net/STORAGE/Storage.yaml` 입력 -> `다음` 클릭
<br/>

<img width="1030" alt="스크린샷 2021-06-30 오후 10 24 39" src="https://user-images.githubusercontent.com/76810787/123975077-11e0e400-d9f8-11eb-8cd0-d8f96d54a38d.png">
<br/>

`스택 이름 : 마음대로` -> `key` 선택 후에 `다음` 선택
<br/>

<img width="1049" alt="스크린샷 2021-06-30 오후 10 25 02" src="https://user-images.githubusercontent.com/76810787/123975084-13121100-d9f8-11eb-8ed4-e972bc1c2468.png">
<br/>

기본값으로 둔 후에 `다음` 클릭
<br/>

<img width="269" alt="스크린샷 2021-06-30 오후 10 25 19" src="https://user-images.githubusercontent.com/76810787/123975096-14433e00-d9f8-11eb-8d86-36a806cf035d.png">
<br/>

맨 하단에 파란색 박스 `체크` 클릭 -> `스택 생성` 클릭
<br/>

<img width="1020" alt="스크린샷 2021-06-30 오후 10 25 34" src="https://user-images.githubusercontent.com/76810787/123975100-14dbd480-d9f8-11eb-9db2-ced314e82537.png">
<br/>

짠 완성 !
<br/>

<img width="899" alt="스크린샷 2021-06-30 오후 10 25 51" src="https://user-images.githubusercontent.com/76810787/123975104-15746b00-d9f8-11eb-924c-7ab8a743f126.png">
<br/>

여러분 제 블로그를 열심히 보셨다면 !!(?) 이제 `인스턴스 연결` 정도면 껌이겠죠 ?!!!
<br>

<img width="886" alt="스크린샷 2021-06-30 오후 10 27 52" src="https://user-images.githubusercontent.com/76810787/123975106-160d0180-d9f8-11eb-9b61-57524e541cc1.png">
<br/>

**EBS 기본 정보 확인**  
<br/>

```
# 루트 사용자로 바꿔줍시다잉
sudo su 

# 디스크 여유 공간 출력
df -hT /dev/xvda1

# 사용 가능한 디스크 디바이스와 마운트 포인트(해당하는 경우)를 출력
lsblk

# 볼륨에 파일 시스템이 있는지 확인, data만 출력 시 파일시스템이 없으므로 생성해야함 
file -s /dev/xvda

# 파일 시스템이 있으면 파일 시스템의 유형에 관한 정보를 출력
file -s /dev/xvda1

# 디바이스의 UUID 찾기
blkid

# 디바이스의 탑재 지점 확인
cat /etc/fstab

```
<br/>

<img width="295" alt="스크린샷 2021-06-30 오후 10 29 15" src="https://user-images.githubusercontent.com/76810787/123975113-16a59800-d9f8-11eb-8e9f-406a00c2635b.png">
<img width="403" alt="스크린샷 2021-06-30 오후 10 30 20" src="https://user-images.githubusercontent.com/76810787/123975118-173e2e80-d9f8-11eb-820f-d0e6729aeff9.png">
<img width="343" alt="스크린샷 2021-06-30 오후 10 30 33" src="https://user-images.githubusercontent.com/76810787/123975121-17d6c500-d9f8-11eb-8760-986de1af9f01.png">
<img width="566" alt="스크린샷 2021-06-30 오후 10 30 45" src="https://user-images.githubusercontent.com/76810787/123975123-186f5b80-d9f8-11eb-93e9-4e45239abe46.png">
<img width="504" alt="스크린샷 2021-06-30 오후 10 31 13" src="https://user-images.githubusercontent.com/76810787/123975127-186f5b80-d9f8-11eb-9c62-35523b422160.png">
<img width="567" alt="스크린샷 2021-06-30 오후 10 31 29" src="https://user-images.githubusercontent.com/76810787/123975131-1907f200-d9f8-11eb-9035-2f396a2ca804.png">
<img width="564" alt="스크린샷 2021-06-30 오후 10 31 42" src="https://user-images.githubusercontent.com/76810787/123975136-1907f200-d9f8-11eb-8c6d-132b8ae493d4.png">

 `EC2` -> `볼륨` -> `볼륨 생성` 클릭
 <br/>

<img width="170" alt="스크린샷 2021-06-30 오후 10 32 11" src="https://user-images.githubusercontent.com/76810787/123975140-19a08880-d9f8-11eb-83d2-dce530bee6ae.png">
<br/>

```
크기 : 20
가용 영역 : 루트 볼륨 영역 (저를 따라하셨다면 a가 맞습니다)
스냅샷 ID : 
태그 : 키 (Name), 값(Data1)
```
`볼륨 생성` 클릭
<br/>

<img width="1193" alt="스크린샷 2021-06-30 오후 10 32 43" src="https://user-images.githubusercontent.com/76810787/123975144-1a391f00-d9f8-11eb-81fb-7a41caed2f51.png">
<br/>

만들어졌습니다 ㅎㅎ
<br/>

<img width="429" alt="스크린샷 2021-06-30 오후 10 33 01" src="https://user-images.githubusercontent.com/76810787/123975151-1ad1b580-d9f8-11eb-9475-fd8b5a1fabf0.png">
<br/>

볼륨에서 `볼륨 연결` 클릭
<br/>

<img width="331" alt="스크린샷 2021-06-30 오후 10 33 21" src="https://user-images.githubusercontent.com/76810787/123975153-1ad1b580-d9f8-11eb-936b-251814842159.png">
<br/>

인스턴스에서 `EC2-STG1` 클릭
<br/>

<img width="647" alt="스크린샷 2021-06-30 오후 10 33 39" src="https://user-images.githubusercontent.com/76810787/123975156-1b6a4c00-d9f8-11eb-8937-0f86ea39312e.png">
<br/>

디바이스 이름을 `xvdf`로 바꿔줍니다 그후에 하단에 `연결` 클릭 !
<br/>

<img width="831" alt="스크린샷 2021-06-30 오후 10 36 07" src="https://user-images.githubusercontent.com/76810787/123975158-1c02e280-d9f8-11eb-8abe-06613f8cd131.png">
<br/>

**EC2-STG1 신규 볼륨 사용 설정**  
<br/>

```
# 관리자 권한으로 변경
sudo su

# 라이브 상태에서 디바이스 추가 확인 됨
lsblk

# 볼륨 ID 확인
lsblk -o +SERIAL

# 현재는 파일 시스템이 없음
file -s /dev/xvdf

# 볼륨을 포맷해서 파일 시스템을 생성
mkfs -t xfs /dev/xvdf

디렉터리를 생성 후 마운트
mkdir /data
mount /dev/xvdf /data

# 파일을 생성 후 확인
echo "EBS Test" > /data/memo.txt
cat /data/memo.txt

# 디바이스 확인
lsblk
df -hT /dev/xvdf
```
<br/>

<img width="329" alt="스크린샷 2021-06-30 오후 10 36 51" src="https://user-images.githubusercontent.com/76810787/123975161-1c02e280-d9f8-11eb-86b6-92d8408071fa.png">
<img width="369" alt="스크린샷 2021-06-30 오후 10 37 09" src="https://user-images.githubusercontent.com/76810787/123975163-1c9b7900-d9f8-11eb-9857-1d14a52650dc.png">
<img width="381" alt="스크린샷 2021-06-30 오후 10 38 05" src="https://user-images.githubusercontent.com/76810787/123975167-1c9b7900-d9f8-11eb-9789-b68e58f19572.png">
<img width="564" alt="스크린샷 2021-06-30 오후 10 38 10" src="https://user-images.githubusercontent.com/76810787/123975170-1d340f80-d9f8-11eb-9932-b60a001e8cf3.png">
<img width="380" alt="스크린샷 2021-06-30 오후 10 38 43" src="https://user-images.githubusercontent.com/76810787/123975171-1dcca600-d9f8-11eb-82e6-1f45730ece51.png">
<img width="482" alt="스크린샷 2021-06-30 오후 10 39 20" src="https://user-images.githubusercontent.com/76810787/123975173-1dcca600-d9f8-11eb-8970-12c588f01284.png">
<img width="330" alt="스크린샷 2021-06-30 오후 10 39 35" src="https://user-images.githubusercontent.com/76810787/123975178-1e653c80-d9f8-11eb-9543-baeab59fa359.png">
<img width="426" alt="스크린샷 2021-06-30 오후 10 39 53" src="https://user-images.githubusercontent.com/76810787/123975181-1efdd300-d9f8-11eb-9fc4-8674fdabec42.png">

## 심화 옵션) EC2-STG1 신규 볼륨 사용 설정시 재부팅 시에도 신규 볼륨을 자동 마운트

```
# 혹시 모르니 fstab 파일 백업
cp /etc/fstab /etc/fstab.orig

# 재부팅 이후에도 볼륨 자동 탑재를 위한 fstab 설정(nofail: 볼륨 없어도 부팅 가능)
blkid

echo "UUID=위blkid의자신의UUID입력  /data  xfs  defaults,nofail  0  2" >> /etc/fstab
cat /etc/fstab

#위 항목이 설정이 잘 되었는지 확인을 위해서 탑재를 해제 후 다시 탑재 (오류가 있을 시 문제를 출력)
umount /data
mount -a

# 다시 재부팅
reboot
```
<br/>

<img width="567" alt="스크린샷 2021-06-30 오후 10 40 42" src="https://user-images.githubusercontent.com/76810787/123975186-1f966980-d9f8-11eb-9832-e24aa93132e5.png">
<img width="567" alt="스크린샷 2021-06-30 오후 10 42 17" src="https://user-images.githubusercontent.com/76810787/123975187-1f966980-d9f8-11eb-9352-c97258fa803f.png">
<img width="570" alt="스크린샷 2021-06-30 오후 10 42 40" src="https://user-images.githubusercontent.com/76810787/123975191-202f0000-d9f8-11eb-93f3-68e95aa68650.png">
<img width="331" alt="스크린샷 2021-06-30 오후 10 43 20" src="https://user-images.githubusercontent.com/76810787/123975195-20c79680-d9f8-11eb-984c-7cb4e8df131f.png">
<img width="569" alt="스크린샷 2021-06-30 오후 10 43 40" src="https://user-images.githubusercontent.com/76810787/123975199-20c79680-d9f8-11eb-81d0-3e2d7d1f627e.png">
<br/>

```
# 정상적으로 디스크 디바이스가 보이고 마운트 되어 있으며 생성한 파일을 확인 가능
lsblk

# memo 파일을 찾아 봅시당
cat /data/memo.txt
```
<br/>

<img width="391" alt="스크린샷 2021-06-30 오후 10 44 47" src="https://user-images.githubusercontent.com/76810787/123975201-21602d00-d9f8-11eb-946f-bf0791b82cd4.png">
<img width="337" alt="스크린샷 2021-06-30 오후 10 45 04" src="https://user-images.githubusercontent.com/76810787/123975205-21f8c380-d9f8-11eb-997f-93d0dd26704a.png">
<br/>

`EC2-STG1볼륨` 클릭 -> `볼륨 수정` 클릭  
<br/>

<img width="312" alt="스크린샷 2021-06-30 오후 10 46 27" src="https://user-images.githubusercontent.com/76810787/123975208-22915a00-d9f8-11eb-8859-53e42b7749c5.png">
<img width="280" alt="스크린샷 2021-06-30 오후 10 46 35" src="https://user-images.githubusercontent.com/76810787/123975210-22915a00-d9f8-11eb-92aa-09b34a96e545.png">
<br/>

```
볼륨 유형 : gp3
크기 : 20
IOPS : 3000
```
`수정` 클릭
<br/>

<img width="606" alt="스크린샷 2021-06-30 오후 10 47 10" src="https://user-images.githubusercontent.com/76810787/123975214-2329f080-d9f8-11eb-9308-6553f06de006.png">
<br/>

## 파일 시스템 확장 : 볼륨이 optimizing 상태가 되자마자 파일 시스템 크기 조정을 할 수 있음 -> 1) 파티션 늘림 -> 2) 파일 시스템 늘림

```
# 현재 루트 볼륨이 20G로 반영되어 있는데 아직 xvda1 파티션 크기가 8G 이므로 파티션 확장이 필요
lsblk

# 아직은 xvda1 크기가 8G 이다
df -hT /dev/xvda1

# 1) growpart 명령어로 파티션을 늘림
growpart /dev/xvda 1

# 늘린 파티션으로 반영이 되었다
lsblk

# 파일 시스템은 아직 여전히 8G
df -hT /dev/xvda1

# 2) xfs_growfs 명령어로 볼륨의 파일 시스템을 확장
xfs_growfs -d /

# 최종적으로 파일시스템까지 20G 용량으로 확장됨
df -hT /dev/xvda1

# 심화 메모
# ext4 볼륨의 경우 아래 명령어로 확장
resize2fs /dev/xvda1
```
추가로 EBS 불륨을 연결 후 다시 해당 볼륨을 확장 시에도 위와 동일한 작업을 진행하면됨
<br/>

<img width="347" alt="스크린샷 2021-06-30 오후 10 47 43" src="https://user-images.githubusercontent.com/76810787/123975219-23c28700-d9f8-11eb-8c59-a62d47c0d44f.png">
<img width="426" alt="스크린샷 2021-06-30 오후 10 47 55" src="https://user-images.githubusercontent.com/76810787/123975224-245b1d80-d9f8-11eb-9054-2c397607d344.png">
<img width="287" alt="스크린샷 2021-06-30 오후 10 48 19" src="https://user-images.githubusercontent.com/76810787/123975231-24f3b400-d9f8-11eb-98ea-34d5f75876e0.png">
<img width="567" alt="스크린샷 2021-06-30 오후 10 48 36" src="https://user-images.githubusercontent.com/76810787/123975235-258c4a80-d9f8-11eb-8d8b-5a6da5a9384a.png">
<img width="356" alt="스크린샷 2021-06-30 오후 10 48 48" src="https://user-images.githubusercontent.com/76810787/123975237-2624e100-d9f8-11eb-8447-f16b9f0a9849.png">
<img width="439" alt="스크린샷 2021-06-30 오후 10 49 02" src="https://user-images.githubusercontent.com/76810787/123975239-2624e100-d9f8-11eb-8b1e-1fdb713f58a5.png">
<img width="548" alt="스크린샷 2021-06-30 오후 10 49 26" src="https://user-images.githubusercontent.com/76810787/123975243-26bd7780-d9f8-11eb-97a5-2aab172e828b.png">
<img width="423" alt="스크린샷 2021-06-30 오후 10 49 46" src="https://user-images.githubusercontent.com/76810787/123975246-27560e00-d9f8-11eb-8cd5-dc1836f54e0e.png">
<br/>

## 심화 옵션) EC2-STG1 의 루트 불륨(EBS) Shapshot(스냅샷) - 증분백업 확인

```
# 더미 파일 생성
fallocate -l 10G /home/10G.dummy //의미없는 파일 생성

ls -alh /home/10G.dummy

df -hT /dev/xvda1

du -hs /home
```
<br/>

<img width="463" alt="스크린샷 2021-06-30 오후 10 52 05" src="https://user-images.githubusercontent.com/76810787/123975251-27560e00-d9f8-11eb-87d2-4fcaa2f013b0.png">
<br/>

`EC2` -> `스냅샷` -> `스냅샷 생성` 클릭
<br/>

<img width="115" alt="스크린샷 2021-06-30 오후 10 53 57" src="https://user-images.githubusercontent.com/76810787/123975255-27eea480-d9f8-11eb-8e5d-6ceb9cf30fc1.png">
<br/>

볼륨 : EC2-STG1
<br/>

<img width="529" alt="스크린샷 2021-06-30 오후 10 54 18" src="https://user-images.githubusercontent.com/76810787/123975260-28873b00-d9f8-11eb-9d84-11345ace1e01.png">
<br/>

설명: FirstSnapshot -> `스냅샷 생성` 클릭
<br/>

<img width="1194" alt="스크린샷 2021-06-30 오후 10 55 10" src="https://user-images.githubusercontent.com/76810787/123975263-291fd180-d9f8-11eb-9678-6c101139c885.png">
<br/>

```
# 더미 파일 생성
fallocate -l 5G /home/1G.dummy
```
<img width="427" alt="스크린샷 2021-07-01 오전 12 08 43" src="https://user-images.githubusercontent.com/76810787/123986322-2b3a5e00-da01-11eb-9b57-454c0577096b.png">
<br/>

`EC2` -> `스냅샷` -> `스냅샷 생성` 클릭
<br/>

<img width="127" alt="스크린샷 2021-07-01 오전 12 09 16" src="https://user-images.githubusercontent.com/76810787/123986328-2d042180-da01-11eb-964e-0eb09d001852.png">
<br/>

볼륨 : EC2-STG1
<br/>

<img width="643" alt="스크린샷 2021-07-01 오전 12 09 24" src="https://user-images.githubusercontent.com/76810787/123986331-2e354e80-da01-11eb-874c-486a81afbb7b.png">
<br/>

설명: SecondSnapshot -> `스냅샷 생성` 클릭
<br/>

<img width="1225" alt="스크린샷 2021-07-01 오전 12 09 50" src="https://user-images.githubusercontent.com/76810787/123986334-2f667b80-da01-11eb-87f9-732089e6eb02.png">
<br/>

두번째 스냅샷의 진행 상황을 봅시다 .. 뭔가 오래 걸릴 거 같군요 ...
<br/>

<img width="245" alt="스크린샷 2021-07-01 오전 12 10 37" src="https://user-images.githubusercontent.com/76810787/123986338-2fff1200-da01-11eb-9f2b-b8a5e8e452a0.png">
<br/>

몇십분 걸릴 줄 알았는데, 몇십초 있으니 바로 생성 됐네요 ... 엄청 빨라요 ..
<br/>

<img width="672" alt="스크린샷 2021-07-01 오전 12 11 07" src="https://user-images.githubusercontent.com/76810787/123986339-2fff1200-da01-11eb-9b3e-1427fefef1b8.png">
<br/>

`EFS` -> `파일 시스템 생성` 클릭
<br/>

<img width="336" alt="스크린샷 2021-07-01 오전 12 11 39" src="https://user-images.githubusercontent.com/76810787/123986342-3097a880-da01-11eb-8304-d73b26f73877.png">
<br/>

```
이름: 마음대로
VPC: ELB-VPC
리전
```
`생성` 클릭
<br/>

<img width="594" alt="스크린샷 2021-07-01 오전 12 12 01" src="https://user-images.githubusercontent.com/76810787/123986345-31303f00-da01-11eb-8b69-4ad461fcf094.png">
<br/>

EFS가 만들어졌네요 자 이름을 클릭해봅시다 !
<br/>

<img width="653" alt="스크린샷 2021-07-01 오전 12 12 20" src="https://user-images.githubusercontent.com/76810787/123986351-31c8d580-da01-11eb-8460-98058d98a03b.png">
<br/>

하단에 `네트워크` 클릭
<br/>

<img width="164" alt="스크린샷 2021-07-01 오전 12 12 26" src="https://user-images.githubusercontent.com/76810787/123986352-32616c00-da01-11eb-8ee0-795a42faa58e.png">
<br/>

`사용 가능` 이라고 뜨면 `관리` 클릭
<br/>

<img width="552" alt="스크린샷 2021-07-01 오전 12 23 06" src="https://user-images.githubusercontent.com/76810787/123994853-c1be4d80-da08-11eb-920b-9bf8ea31615f.png">
<img width="137" alt="스크린샷 2021-07-01 오전 12 23 09" src="https://user-images.githubusercontent.com/76810787/123994864-c4b93e00-da08-11eb-9ea0-a9ce91d84d32.png">
<br/>

맨 하단에 보안그룹 전부 제거
<br/>
<img width="441" alt="스크린샷 2021-07-01 오전 12 23 29" src="https://user-images.githubusercontent.com/76810787/123994868-c551d480-da08-11eb-877e-4046f2a0a4df.png">
<img width="339" alt="스크린샷 2021-07-01 오전 12 23 35" src="https://user-images.githubusercontent.com/76810787/123994874-c5ea6b00-da08-11eb-999e-c16374eba33f.png">
<br/>

`default`말고 다른 보안 그룹 클릭
<br/>
<img width="329" alt="스크린샷 2021-07-01 오전 12 23 44" src="https://user-images.githubusercontent.com/76810787/123994876-c5ea6b00-da08-11eb-8262-a297fffffa97.png">
<img width="317" alt="스크린샷 2021-07-01 오전 12 23 54" src="https://user-images.githubusercontent.com/76810787/123994877-c6830180-da08-11eb-888e-d0f8a13f6f4c.png">
<img width="510" alt="스크린샷 2021-07-01 오전 12 24 03" src="https://user-images.githubusercontent.com/76810787/123994881-c71b9800-da08-11eb-8e91-d678b07c6f42.png">
<br/>

**EC2-STG1 에 EFS 마운트**
```
curl localhost
mkdir /var/www/html/efs
mount -t efs -o tls 자신의-EFS-ID:/ /var/www/html/efs
echo "<html><h1>Hello from Amazon EFS</h1></html>" > /var/www/html/efs/index.html
curl localhost/efs/
df |grep efs
df -hT |grep efs
dig +short 자신의-EFS-ID.efs.ap-northeast-2.amazonaws.com
```
<img width="385" alt="스크린샷 2021-07-01 오전 12 24 36" src="https://user-images.githubusercontent.com/76810787/123994886-c7b42e80-da08-11eb-8ef4-9ee2325b357f.png">
<img width="395" alt="스크린샷 2021-07-01 오전 12 25 25" src="https://user-images.githubusercontent.com/76810787/123994887-c84cc500-da08-11eb-85ee-dcf670167739.png">
<img width="565" alt="스크린샷 2021-07-01 오전 12 26 08" src="https://user-images.githubusercontent.com/76810787/123994890-c84cc500-da08-11eb-94a8-99de5c9cc2a1.png">
<img width="570" alt="스크린샷 2021-07-01 오전 12 27 36" src="https://user-images.githubusercontent.com/76810787/123994892-c8e55b80-da08-11eb-91fb-5b5a911445f4.png">
<img width="350" alt="스크린샷 2021-07-01 오전 12 27 42" src="https://user-images.githubusercontent.com/76810787/123994893-c97df200-da08-11eb-9c51-7c65ebcd690b.png">
<img width="567" alt="스크린샷 2021-07-01 오전 12 27 47" src="https://user-images.githubusercontent.com/76810787/123994894-c97df200-da08-11eb-83b5-80b1cc05d0f9.png">
<img width="516" alt="스크린샷 2021-07-01 오전 12 28 26" src="https://user-images.githubusercontent.com/76810787/123994895-ca168880-da08-11eb-8256-070079adba88.png">
<img width="567" alt="스크린샷 2021-07-01 오전 12 33 07" src="https://user-images.githubusercontent.com/76810787/123994918-cd117900-da08-11eb-83e5-92f64e9742ef.png">
<br/>

**EC2-STG2 에 EFS 마운트**
```
sudo su
mkdir /var/www/html/efs
mount -t efs -o tls 자신의-EFS-ID:/ /var/www/html/efs
curl localhost/efs/
df -hT |grep efs
dig +short 자신의-EFS-ID.efs.ap-northeast-2.amazonaws.com
```
<br/>
<img width="301" alt="스크린샷 2021-07-01 오전 12 29 48" src="https://user-images.githubusercontent.com/76810787/123994900-caaf1f00-da08-11eb-82f6-1dae61dbf012.png">
<img width="560" alt="스크린샷 2021-07-01 오전 12 30 53" src="https://user-images.githubusercontent.com/76810787/123994903-cb47b580-da08-11eb-83e6-0f5a83833b0a.png">
<img width="406" alt="스크린샷 2021-07-01 오전 12 30 58" src="https://user-images.githubusercontent.com/76810787/123994909-cbe04c00-da08-11eb-925a-820fe41dd7b1.png">
<img width="494" alt="스크린샷 2021-07-01 오전 12 31 16" src="https://user-images.githubusercontent.com/76810787/123994913-cc78e280-da08-11eb-82e5-76d0086361f3.png">
<img width="1210" alt="스크린샷 2021-07-01 오전 12 32 59" src="https://user-images.githubusercontent.com/76810787/123994917-cc78e280-da08-11eb-8f2e-867a1404104b.png">
<br/>
```
# 파일 100개 생성
for i in {1..100}; do touch /var/www/html/efs/deleteme.$i; done;
```

<br/>

<img width="567" alt="스크린샷 2021-07-01 오전 12 33 46" src="https://user-images.githubusercontent.com/76810787/123994922-cd117900-da08-11eb-8b4a-0fbbf3c8691f.png">
<br/>

```
# 파일 확인
ls /var/www/html/efs
```
<br/>
<img width="561" alt="스크린샷 2021-07-01 오전 12 34 02" src="https://user-images.githubusercontent.com/76810787/123994923-cdaa0f80-da08-11eb-90a7-e1dd7362a4ee.png">
<br/>

EC2-STG1도 똑같이 100개의 파일이 보인다 (처음 봤을 때 완전 신기 ..)
<br/>

<img width="1214" alt="스크린샷 2021-07-01 오전 12 34 31" src="https://user-images.githubusercontent.com/76810787/123994926-ce42a600-da08-11eb-8dcf-20d94d34f431.png">
<br/>

**EC2-STG1에서 파일 삭제**
<br/>

```
# 파일 삭제
rm -rf /var/www/html/efs/deleteme*.*

# 짜쟌 파일이 사라졌습니다
ls /var/www/html/efs
```
<br/>

<img width="531" alt="스크린샷 2021-07-01 오전 12 35 42" src="https://user-images.githubusercontent.com/76810787/123994936-cf73d300-da08-11eb-86ab-a172118ca3ef.png">
<br/>

두개의 인스턴스에서 전부 파일이 사라진 걸 확인해볼 수 있습니다 !
<br/>
<img width="1019" alt="스크린샷 2021-07-01 오전 12 35 56" src="https://user-images.githubusercontent.com/76810787/123994940-cf73d300-da08-11eb-90b0-6e198ce84d9f.png">
<br/>

# 재부팅에서 EFS 자동 탑재

```
# 마운트 해제
umount /var/www/html/efs

# /etc/fatab 에 아래 내용 추가
echo "자신의-EFS-ID:/ /var/www/html/efs efs _netdev,noresvport,tls,iam 0 0" >> /etc/fstab

# 다시 마운트 해주기
mount -fav

# 재부팅
reboot
```
<br/>

<img width="387" alt="스크린샷 2021-07-01 오전 12 38 38" src="https://user-images.githubusercontent.com/76810787/123994943-d00c6980-da08-11eb-80eb-2d5f70b6a5cc.png">
<img width="570" alt="스크린샷 2021-07-01 오전 12 38 43" src="https://user-images.githubusercontent.com/76810787/123994944-d00c6980-da08-11eb-9e43-16cc6e6704f9.png">
<img width="378" alt="스크린샷 2021-07-01 오전 12 39 07" src="https://user-images.githubusercontent.com/76810787/123994946-d0a50000-da08-11eb-8dd0-71dfd9a07dfe.png">
<img width="566" alt="스크린샷 2021-07-01 오전 12 39 17" src="https://user-images.githubusercontent.com/76810787/123994948-d13d9680-da08-11eb-9506-5c37105ed7f2.png">
<br/>

재부팅 후 자동 탑재 확인
```
df -hT |grep nfs
```
<br/>

<img width="504" alt="스크린샷 2021-07-01 오전 12 40 20" src="https://user-images.githubusercontent.com/76810787/123994950-d13d9680-da08-11eb-896c-d62b9d448829.png">
<br/>
<br/>

## 자원 삭제

**EC2 인스턴스 종료
EBS 스냅샷 삭제
EBS 볼륨 삭제
EFS 삭제
S3 삭제
CloudFormation 삭제**

<br/>
<br/>
<br/>

<hr/>

**참고 자료 : AFOS[2기] 노션 내용**
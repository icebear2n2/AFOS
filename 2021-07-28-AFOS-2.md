---
title:  "[AWS] 8주차-2 EC2 Auto Scaling 구성 실습"
subtitle:   "EC2 Auto Scaling 구성 실습"
date: 2021-07-28 23:00:00
categories: AWS
tags: AFOS[2기]
---

## CloudFormation 스택 생성

https://console.aws.amazon.com/cloudformation/home?region=ap-northeast-2#/stacks/new?stackName=AutoScalingLab&templateURL=https:%2F%2Fcloudneta-book.s3.ap-northeast-2.amazonaws.com%2Fchapter5%2Fautoscaling-AFOS.yaml

`다음` 클릭
<img width="1032" alt="스크린샷 2021-07-28 오후 10 02 04" src="https://user-images.githubusercontent.com/87232411/127346525-ac77a844-2f6c-4195-a8b7-535d97466ca4.png">

키 선택 후 `다음` 클릭
<img width="1040" alt="스크린샷 2021-07-28 오후 10 02 15" src="https://user-images.githubusercontent.com/87232411/127346533-2e31b8eb-132a-4677-9c67-b0087f936fe6.png">

기본 값으로 둔 후 `다음` 클릭
<img width="259" alt="스크린샷 2021-07-28 오후 10 02 26" src="https://user-images.githubusercontent.com/87232411/127346537-af87e995-8fc7-4f37-9b09-ec2379b05148.png">

파란 박스 체크 후 `스택 생성` 클릭
<img width="1067" alt="스크린샷 2021-07-28 오후 10 02 35" src="https://user-images.githubusercontent.com/87232411/127346540-42f2ee0d-739e-4533-a53a-211519e9dad2.png">

## 기본 환경 검증 - MyEC2 SSH 접속
```bash
# AWS CLI 확인
aws --version
aws ec2 describe-instances
aws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress]' --output text

while true; do aws ec2 describe-instances --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress]' --output text; date; sleep 1; done

# ApachBench 확인
ab -V

# ALB DNS 이름 변수 지정
ALB=ALB-TEST-1714841830.ap-northeast-2.elb.amazonaws.com
dig +short $ALB
while true; do curl $ALB --silent --connect-timeout 1; date; echo "---[AutoScaling]---"; sleep 1; done
```
<img width="670" alt="스크린샷 2021-07-28 오후 10 09 56" src="https://user-images.githubusercontent.com/87232411/127346547-b0704acc-c268-4023-923d-2aa138e40435.png">
<img width="604" alt="스크린샷 2021-07-28 오후 10 11 51" src="https://user-images.githubusercontent.com/87232411/127346549-a4dd5da8-1647-4626-9290-02dd9c9a82d7.png">
<img width="599" alt="스크린샷 2021-07-28 오후 10 12 07" src="https://user-images.githubusercontent.com/87232411/127346552-2aedd53e-91d4-4817-b02d-40686ecff32d.png">
<img width="577" alt="스크린샷 2021-07-28 오후 10 13 17" src="https://user-images.githubusercontent.com/87232411/127346553-7aa25b2b-b00c-4ff2-a9c6-3618d8619685.png">
<img width="605" alt="스크린샷 2021-07-28 오후 10 13 42" src="https://user-images.githubusercontent.com/87232411/127346557-775a7b37-69f8-4fd6-b549-8c16752ff946.png">

EC2->시작 템플릿 -> `시작 템플릿 생성` 클릭
<img width="225" alt="스크린샷 2021-07-28 오후 10 14 22" src="https://user-images.githubusercontent.com/87232411/127346559-2cffb422-b28c-4a04-970f-54a4c77603cb.png">

```bash
시작 템플릿 이름 : EC2LaunchTemplate
설명 : EC2 Auto Scaling v1.0
Auto Scaling 지침 : 체크
AMI : Amazon Linux 2 AMI(HVM), SSD Volume Type - 아키텍처 : 64비트(x86)
인스턴스 유형 : t2.micro
키 페어 : (각자 자신의 SSH 키페어 선택)
네트워킹 플랫폼 : VPC
보안 그룹 : ###-VPC1SG-### 포함된것 선택
리소스 태그 : 키(Lab) , 값(ASLab)
고급 세부 정보 ← 클릭
- 세부 CloudWatch 모니터링 : 활성화
- 사용자 데이터 : 아래 내용 복붙!
```
```bash
#!/bin/bash
RZAZ=`curl http://169.254.169.254/latest/meta-data/placement/availability-zone-id`
IID=`curl 169.254.169.254/latest/meta-data/instance-id`
LIP=`curl 169.254.169.254/latest/meta-data/local-ipv4`
amazon-linux-extras install -y php7.2
yum install httpd htop tmux -y
systemctl start httpd && systemctl enable httpd
echo "<h1>RegionAz($RZAZ) : Instance ID($IID) : Private IP($LIP) : Web Server</h1>" > /var/www/html/index.html
echo "1" > /var/www/html/HealthCheck.txt
curl -o /var/www/html/load.php https://cloudneta-book.s3.ap-northeast-2.amazonaws.com/chapter5/load.php --silent
curl -o /var/www/html/cpuload.php https://cloudneta-book.s3.ap-northeast-2.amazonaws.com/chapter5/cpuload-aws.php --silent
```
<img width="883" alt="스크린샷 2021-07-28 오후 10 15 14" src="https://user-images.githubusercontent.com/87232411/127346562-f068a7b0-a9dc-4346-b336-93aa1c147828.png">
<img width="846" alt="스크린샷 2021-07-28 오후 10 15 21" src="https://user-images.githubusercontent.com/87232411/127346565-900e6564-91e2-4302-b06a-7e9d33fbb5d4.png">
<img width="846" alt="스크린샷 2021-07-28 오후 10 15 44" src="https://user-images.githubusercontent.com/87232411/127346570-a3a93571-a50f-4946-bf78-d937d766bbf6.png">
<img width="845" alt="스크린샷 2021-07-28 오후 10 16 09" src="https://user-images.githubusercontent.com/87232411/127346573-97f1369f-a6ff-4792-a8bd-417b0d9964b4.png">
<img width="2" alt="스크린샷 2021-07-28 오후 10 16 39" src="https://user-images.githubusercontent.com/87232411/127346578-3ffe695a-643e-4fc7-9f01-ce9cfdf7c77d.png">
<img width="838" alt="스크린샷 2021-07-28 오후 10 16 46" src="https://user-images.githubusercontent.com/87232411/127346582-0ba44fab-c77d-4d98-9721-c10b926c212b.png">
<img width="831" alt="스크린샷 2021-07-28 오후 10 16 51" src="https://user-images.githubusercontent.com/87232411/127346584-2d7a7a4a-cf05-4ed5-94e1-c9089e4f626f.png">

<img width="837" alt="스크린샷 2021-07-28 오후 10 17 14" src="https://user-images.githubusercontent.com/87232411/127346587-dbab3a9f-5fe4-4657-9d1e-1eef9849d278.png">


## 시작 템플릿 구성

생성돤 시작 템플릿 -> `Auto Scaling 그룹 생성` 클릭
<img width="1047" alt="스크린샷 2021-07-28 오후 10 17 45" src="https://user-images.githubusercontent.com/87232411/127346591-7dc80ffe-d4c4-4c7d-a135-efa44c61dae4.png">

```bash
Auto Scaling 그룹 이름 : FirstEC2AutoScalingGroup
시작 템플릿 : EC2LaunchTemplate
```
<img width="850" alt="스크린샷 2021-07-28 오후 10 18 02" src="https://user-images.githubusercontent.com/87232411/127346594-3601bc51-6bf4-49cc-a6e8-918ec0aa0ccf.png">
<img width="215" alt="스크린샷 2021-07-28 오후 10 18 09" src="https://user-images.githubusercontent.com/87232411/127346595-0d41fb02-4b00-4785-b5d2-e23ca72ffdcb.png">

```bash
인스턴스 구매 옵션 : 시작 템플릿 준수
네트워크 - VPC : VPC1
네트워크 - 서브넷 : VPC1-Public-SN-1 , VPC1-Public-SN-2
```
<img width="845" alt="스크린샷 2021-07-28 오후 10 18 29" src="https://user-images.githubusercontent.com/87232411/127346596-9d233cc6-2b83-4b7d-948b-8dd08802564c.png">

```bash
로드 밸런싱 : 기존 로드 밸런서에 연결
로그 밸런서 대상 그룹에서 선택 : 선택
기존 로드 밸런서 대상 그룹 : ALB-TG
상태 확인 유형 : ELB (Check)
상태 확인 유예 기간 : 60초
모니터링 - CloudWatch 내에서 그룹 지표 수집 활성화 : 체크
```
<img width="856" alt="스크린샷 2021-07-28 오후 10 18 50" src="https://user-images.githubusercontent.com/87232411/127346597-0dcdb76c-0258-40d2-8d44-213561469a06.png">
<img width="844" alt="스크린샷 2021-07-28 오후 10 19 05" src="https://user-images.githubusercontent.com/87232411/127346601-75a34a0a-1ce0-4c9b-abaf-29cd73eabc6b.png">

```bash
원하는 용량 : 1
최소 용량 : 1
최대 용량 : 4
조정 정책 : 대상 추척 조정 정책
조정 정책 이름 : Scale Out Policy
대상 값 : 80 → 3분 동안 3번 연속 CPU 80% 경우(1분 마다 기록)
인스턴스 요구 사항 : 60초 → 지표에 포함하기 전 워밍업 시간(초)
확대 정책만 생성하려면 축소 비활성화 : Check → 축소는 직접 정책 추가 예정
인스턴스 축소 보호 활성화 : UnCheck
```
<img width="876" alt="스크린샷 2021-07-28 오후 10 19 27" src="https://user-images.githubusercontent.com/87232411/127346605-43d3f0d5-bf4b-47a9-a0c6-087a4bfc5067.png">
<img width="869" alt="스크린샷 2021-07-28 오후 10 20 22" src="https://user-images.githubusercontent.com/87232411/127346610-7560c21d-66d3-4300-a6e2-276baed6709a.png">
<img width="847" alt="스크린샷 2021-07-28 오후 10 20 29" src="https://user-images.githubusercontent.com/87232411/127346612-ce25bc91-737e-4d07-8f11-17d77a882a5a.png">

`다음` 클릭
<img width="514" alt="스크린샷 2021-07-28 오후 10 20 41" src="https://user-images.githubusercontent.com/87232411/127346616-6b2bec11-6907-4aa1-9db2-efffa249e2ac.png">

```bash
태그 : 키(Name) , 값(WebServers)
```
` 다음` 클릭
<img width="867" alt="스크린샷 2021-07-28 오후 10 21 11" src="https://user-images.githubusercontent.com/87232411/127346617-64c30e1f-a0b9-41f4-a20c-748c31a32cfa.png">

`Auto Scaling 그룹 생성` 클릭
<img width="339" alt="스크린샷 2021-07-28 오후 10 21 20" src="https://user-images.githubusercontent.com/87232411/127346623-b34dc1e4-82a4-495d-8da4-dcdcf2c938a2.png">

짜쟌
<img width="778" alt="스크린샷 2021-07-28 오후 10 21 31" src="https://user-images.githubusercontent.com/87232411/127346626-41b2388f-455e-447a-83a8-ae7f202800f6.png">

생성된 Auto Scaling 그룹 클릭 → 세부 정보 → 하단 고급 구성 편집 클릭
<img width="419" alt="스크린샷 2021-07-28 오후 10 21 45" src="https://user-images.githubusercontent.com/87232411/127346628-291c2ae9-b771-4653-9142-7bc3de7fd03e.png">
<img width="1110" alt="스크린샷 2021-07-28 오후 10 21 53" src="https://user-images.githubusercontent.com/87232411/127346632-d48457b8-70a2-4676-9c20-8ddc675f8bc2.png">

```bash
종료 정책 : Newest Instance → 기본 Default 는 제거
기본 휴지 기간 : 180초
```
`업데이트` 클릭
<img width="842" alt="스크린샷 2021-07-28 오후 10 22 26" src="https://user-images.githubusercontent.com/87232411/127346633-4bf9ed69-0065-4ff7-a439-4467de9935ba.png">

## 축소 정책 추가

생성된 Auto Scaling 그룹 클릭 → 자동 조정 → `Create dynamic scaling policy ` 클릭
<img width="1063" alt="스크린샷 2021-07-28 오후 10 23 12" src="https://user-images.githubusercontent.com/87232411/127346638-f681d0b4-4809-42c5-a886-26a599a8e13d.png">

정책 유형(단순 조정) 선택 후 CloudWatch 경보 생성 클릭
<img width="551" alt="스크린샷 2021-07-28 오후 10 23 43" src="https://user-images.githubusercontent.com/87232411/127346642-84074763-bf7f-459d-9f3a-9a11fb9813f9.png">

`지표 선택` 클릭
<img width="493" alt="스크린샷 2021-07-28 오후 10 23 58" src="https://user-images.githubusercontent.com/87232411/127346647-74269bee-9c44-4815-951c-f72eba3c335e.png">

`EC2` 클릭
<img width="293" alt="스크린샷 2021-07-28 오후 10 24 12" src="https://user-images.githubusercontent.com/87232411/127346651-b86e11c6-7b58-4c05-98d5-beaeda10c541.png">

`Auto Scaling 그룹별` 클릭
<img width="303" alt="스크린샷 2021-07-28 오후 10 24 19" src="https://user-images.githubusercontent.com/87232411/127346654-6cbd22d5-58b7-440a-8415-ce23bd6e9876.png">

`CPUUtilization` 클릭 -> `지표 선택` 클릭
<img width="1225" alt="스크린샷 2021-07-28 오후 10 24 41" src="https://user-images.githubusercontent.com/87232411/127346656-e51649fd-8915-47b7-a4dd-84042ef0faf4.png">

`기간: 1분` 클릭
<img width="809" alt="스크린샷 2021-07-28 오후 10 24 55" src="https://user-images.githubusercontent.com/87232411/127346663-7c37517a-160b-42ef-a17d-6bf458380d94.png">

정적 -> 보다 작음 -> ...보다(10) -> 경보를 알릴 데이터 포인트 (2/2) -> `다음` 클릭
<img width="807" alt="스크린샷 2021-07-28 오후 10 25 28" src="https://user-images.githubusercontent.com/87232411/127346676-268276c6-bc44-41ca-929f-a44bf762a746.png">

경보 상태 트리거 제거 -> `다음` 클릭
<img width="828" alt="스크린샷 2021-07-28 오후 10 25 47" src="https://user-images.githubusercontent.com/87232411/127346679-3690d25b-d7d1-4571-a4b5-d12e4943a2a3.png">
<img width="237" alt="스크린샷 2021-07-28 오후 10 25 53" src="https://user-images.githubusercontent.com/87232411/127346682-3eeec42e-5b75-44d0-a47b-2a61b9f063a0.png">

경보 이름: ASG-CpuLow -> `다음` 클릭
<img width="808" alt="스크린샷 2021-07-28 오후 10 26 10" src="https://user-images.githubusercontent.com/87232411/127346685-b43b010b-e85b-45a9-a2c6-598e4a0d9626.png">

`경보 생성` 클릭
<img width="264" alt="스크린샷 2021-07-28 오후 10 26 18" src="https://user-images.githubusercontent.com/87232411/127346689-12dce6dd-dbbd-4a50-aa23-f9941e2765a2.png">

경보가 만들어졌습니다
<img width="434" alt="스크린샷 2021-07-28 오후 10 26 32" src="https://user-images.githubusercontent.com/87232411/127346692-0bdd072a-e381-4674-b92b-bb4a2bd1d3dc.png">

```bash
정책 유형: 단순 조정
조정 정책 이름: Scale In Policy
CloudWatch: ASG-CpuLow
작업 수행: 제거, 1(용량 단위)
그런 다음 대기: 60
```

생성 클릭
<img width="849" alt="스크린샷 2021-07-28 오후 10 26 58" src="https://user-images.githubusercontent.com/87232411/127346694-098513bf-43e6-41f0-bf3f-8fb60d56f187.png">

CloudWatch 경보 2개를 대시보드에 추가
<img width="1123" alt="스크린샷 2021-07-28 오후 10 27 22" src="https://user-images.githubusercontent.com/87232411/127346703-ca1ca3f4-cb89-4a5c-bdb9-e44a45237fb9.png">

이름 마음대로 -> 기본 값 -> `대시보드에 추가` 클릭
<img width="956" alt="스크린샷 2021-07-28 오후 10 28 00" src="https://user-images.githubusercontent.com/87232411/127346708-99954eee-f0b1-49c0-89d5-0be5a40748a0.png">

`위젯 추가` 클릭
<img width="388" alt="스크린샷 2021-07-28 오후 10 31 18" src="https://user-images.githubusercontent.com/87232411/127346712-327d9c5b-61ec-45eb-af2c-58aefb367aba.png">

`행` 클릭  -> `다음` 클릭
<img width="911" alt="스크린샷 2021-07-28 오후 10 31 24" src="https://user-images.githubusercontent.com/87232411/127346715-28094844-5148-4961-a03b-76539a3b44af.png">
-> `지표` 클릭 -> `구성` 클릭 
<img width="909" alt="스크린샷 2021-07-28 오후 10 31 30" src="https://user-images.githubusercontent.com/87232411/127346719-89266004-fcff-49e5-a4af-1b280a92e7b1.png">

 `GroupInServiceInstances` 검색 후 선택 
<img width="1378" alt="스크린샷 2021-07-28 오후 10 31 59" src="https://user-images.githubusercontent.com/87232411/127346720-030f6769-ff88-4c26-a35d-538f12a70dc7.png">

통계: 평균, 기간: 1분 설정 후 -> `위젯 생성` 클릭
<img width="537" alt="스크린샷 2021-07-28 오후 10 32 52" src="https://user-images.githubusercontent.com/87232411/127346724-40e2e4f4-cb9a-413d-bc9c-d763e21cbea0.png">

최종 모습
<img width="1180" alt="스크린샷 2021-07-28 오후 10 33 44" src="https://user-images.githubusercontent.com/87232411/127346726-cba2541c-cc44-4ec8-9599-db4a1d03c6da.png">

## EC2 인스턴스에 CPU 부하 발생 및 Auto Scaling 확인

배포된 Web EC2. 접속

아이피 주소를 웹 창에 입력하면 인스턴스 정보가 뜨는 걸 알 수 있다
<img width="1376" alt="스크린샷 2021-07-29 오전 12 49 59" src="https://user-images.githubusercontent.com/87232411/127360368-5abf6bfd-8158-443e-97bd-ddf15e26d726.png">

인스턴스가 아직 1개이다
```
while true; do curl $ALB --silent --connect-timeout 1; date; echo "---[AutoScaling]---"; sleep 1; done

while true; do aws ec2 describe-instances --filter "Name=tag:Lab,Values=ASLab" --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress]' --output text; date; sleep 1; done
```
<img width="1036" alt="스크린샷 2021-07-29 오전 12 54 29" src="https://user-images.githubusercontent.com/87232411/127360378-6f36369c-511a-451b-b8e9-3d9cf6c41a73.png">

Auto Scaling 그룹 -> 작업 기록 -> 성공적으로 런치된 걸 볼 수 있다.
<img width="963" alt="스크린샷 2021-07-29 오전 12 55 40" src="https://user-images.githubusercontent.com/87232411/127360388-22a8208e-318c-43b3-afed-944bf7faf5fd.png">

```bash
## (심화 옵션) Client IP 확인
vim /etc/httpd/conf/httpd.conf
196 shift+G
%{X-Forwarded-For}i 
systemctl reload httpd
tail -f /var/log/httpd/access_log |grep -v "ELB-HealthChecker/2.0"
```
<img width="466" alt="스크린샷 2021-07-29 오전 12 59 11" src="https://user-images.githubusercontent.com/87232411/127360401-8efb1442-95d2-4cf8-9274-c6b3bcd92685.png">

<img width="309" alt="스크린샷 2021-07-29 오전 12 58 47" src="https://user-images.githubusercontent.com/87232411/127360395-628065f1-8577-46bd-8473-cc7f3880ab77.png">


`curl $ALB` 를 쳤을 때는  CPU 사용량이 적은 걸 알 수 있다.
<img width="1155" alt="스크린샷 2021-07-29 오전 1 02 39" src="https://user-images.githubusercontent.com/87232411/127360404-46f6f1ef-8c0b-40e2-a9de-bb986b5513b5.png">

## MyEC2 SSH 접속 ⇒ ab 부하발생 → 4분(1대 증가) → ab off(ctrl+c) → for 접속으로 부하분산 확인

```bash
# 접속 시 마다 CPU 부하 발생
curl $ALB/load.php;echo
```
<img width="478" alt="스크린샷 2021-07-29 오전 1 03 20" src="https://user-images.githubusercontent.com/87232411/127360412-67bb48d5-8e7e-4887-ade9-a8b7a262e4f9.png">

갑자기 CPU 사용량이 올랐다가 내려가는 걸 볼 수 있다.
<img width="223" alt="스크린샷 2021-07-29 오전 1 03 10" src="https://user-images.githubusercontent.com/87232411/127360411-6ea46fa4-2fba-4fb4-885d-93398a39eb69.png">

```bash
# 1개 요청(풀)로 총합 500번 요청 진행
ab -n 500 -c 1 http://$ALB/load.php
```
CPU 사용량이 계속 증가한다
<img width="349" alt="스크린샷 2021-07-29 오전 1 05 28" src="https://user-images.githubusercontent.com/87232411/127360417-5a37b067-6d22-4179-965a-7121225740eb.png">

ALBDNS 주소로 웹 접속 후 주소 뒤에 /lcpuload.php 를 넣으면 CPU 사용량을 볼 수 있다.
<img width="682" alt="스크린샷 2021-07-29 오전 1 06 53" src="https://user-images.githubusercontent.com/87232411/127360432-8eed1794-0a9c-4b5a-a091-ace8a029e921.png">


CloudWatch 경보 대시보드를 보면 계속해서 그래프가 증가하는 걸 볼 수 있다.
<img width="740" alt="스크린샷 2021-07-29 오전 1 07 29" src="https://user-images.githubusercontent.com/87232411/127360436-9283490d-f7fe-4ee7-a382-a67860559644.png">


## 실수
GroupInServiceInstances 경보 -> 그래프 옵션 -> Y축 한도를 최소 0, 최대 4로 설정 후 확인
<img width="567" alt="스크린샷 2021-07-29 오전 1 11 07" src="https://user-images.githubusercontent.com/87232411/127360438-a149cacd-a793-45d1-aef8-206403aaf9cb.png">
<img width="736" alt="스크린샷 2021-07-29 오전 1 13 11" src="https://user-images.githubusercontent.com/87232411/127360441-82e06e7c-be4a-4d2a-bbbb-994d60092486.png">


확대 조정 정책 경보를 보면 계속 증가하면서 CPU 부하가 80%가 넘으니 경보를 울리는 걸 알 수 있다.
<img width="754" alt="스크린샷 2021-07-29 오전 1 13 53" src="https://user-images.githubusercontent.com/87232411/127360445-5d2e1a1e-6082-46e4-a24d-7793065f2b9f.png">

<img width="1" alt="스크린샷 2021-07-29 오전 1 17 37" src="https://user-images.githubusercontent.com/87232411/127360451-6544dd65-7661-4691-b1ef-cc258d53a9c0.png">

```bash
while true; do aws ec2 describe-instances --filter "Name=tag:Lab,Values=ASLab" --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress]' --output text; date; sleep 1; done
```
전에는 인스턴스가 하나였는데 CPU 사용량 증가 이후  Auto Scaling 그룹 설정으로 3개로 증가했다.

<img width="532" alt="스크린샷 2021-07-29 오전 1 17 46" src="https://user-images.githubusercontent.com/87232411/127360453-90733e5d-61bf-4700-8012-df77045ea7b9.png">
<img width="888" alt="스크린샷 2021-07-29 오전 1 17 56" src="https://user-images.githubusercontent.com/87232411/127360459-87152bad-1044-4383-991b-c53bbbc9e20a.png">

CloudWatch 경보에서도 확인할 수 있다.
<img width="1331" alt="스크린샷 2021-07-29 오전 1 18 11" src="https://user-images.githubusercontent.com/87232411/127360465-02a3d5ff-6fa2-4a27-ab65-2cb639837e54.png">

```
# EC2 증가 이후 증감 확인
for i in {1..100}; do curl $ALB --silent ; done | sort | uniq -c | sort -nr
```
<img width="531" alt="스크린샷 2021-07-29 오전 1 18 58" src="https://user-images.githubusercontent.com/87232411/127360468-b089b18c-f4ab-4df7-8951-2d47cdcbb9a5.png">

이제 CPU 사용량을 0으로 하면 
<img width="206" alt="스크린샷 2021-07-29 오전 1 19 20" src="https://user-images.githubusercontent.com/87232411/127360470-9ee7a813-121a-491e-b3e8-45aa2fc08dc3.png">'

축소 조정 정책 경보가 울린다
<img width="730" alt="스크린샷 2021-07-29 오전 1 19 35" src="https://user-images.githubusercontent.com/87232411/127360473-58f66a29-fcb7-42f0-88f2-5bff87bc64d2.png">

인스턴스도 감소하는 걸 볼 수 있다.
<img width="881" alt="스크린샷 2021-07-29 오전 1 21 21" src="https://user-images.githubusercontent.com/87232411/127360496-0261a0a5-6aab-4ffe-807c-78a1a71d1bf5.png">

EC2 -> Auto Scaling 그룹 -> 활동 -> 작업 기록을 보면 기록이 남아있다.
![스크린샷 2021-07-29 오전 2 06 22](https://user-images.githubusercontent.com/87232411/127366192-1212cb03-a038-4fc3-917e-d9d1a4228f8f.png)


## 자원 삭제(중요!)

### CloudWatch (대시보드에 추가된 지표 Metric 삭제 → 대시보드 삭제)
### EC2 Auto Scaling Group 삭제
### EC2 시작 템플릿(Launch Templates) 삭제
### CloudFormation 템플릿 스택 삭제

<br/>
<br/>
<br/>

<hr/>

**참고 자료 : AFOS[2기] 노션 내용**
